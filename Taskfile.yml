version: "3"

dotenv:
  - .env

includes:
  db:
    taskfile: ./db/Taskfile.yml
    dir: ./db

tasks:
  default:
    deps:
      - server
      - worker
      - db:compile:watch

  server:
    desc: Run the HTTP server.
    aliases:
      - serve
      - s
    cmds:
      - wgo run main.go server

  test:
    desc: Run the test suite.
    aliases:
      - t
    cmds:
      - go test -v ./...

  worker:
    desc: Run the background worker.
    aliases:
      - work
      - w
    cmds:
      - wgo run main.go worker
